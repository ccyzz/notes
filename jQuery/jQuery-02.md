# jQuery 基础

### 主要内容

1. 强大的 jQuery 选择器, 过滤器
2. 与选择器对应的查找方法
3. 事件操作



### 重难点

1. 选择器非常多, 不难, 但是不容易记忆
2. 过滤器的使用**[ 难点 ]**
3. 选择器对应的方法**[ 难点 ]**
4. 事件对象的使用
5. 事件的触发
6. 事件代理





## 1. 常用选择器

### 1.1 基本选择器

前面已经介绍过 jQuery 的基本用法了, 也说明了基本选择器的使用方法. 这里仅仅是做一个小结.

| 选择器       | 示例                                | 含义                                               |
| ------------ | ----------------------------------- | -------------------------------------------------- |
| `#id`        | `$('#dv')` 或 `jQuery( '#dv' )`     | id 选择器, 用于获得对应 id 的元素                  |
| `.className` | `$( '.btn' )` 或 `jQuery( '.btn' )` | 类选择器, 用于获得所有使用了该类样式的元素         |
| `div`        | `$( 'div' )` 或 `jQuery( 'div' )`   | 标签选择器, 直接使用标签名, 用于获得该标签元素     |
| `*`          | `$( '*' )` 或 `jQuery( '*' )`       | 通用选择器, 用于获得所有元素, **一般很少直接使用** |



### 1.2 层次选择器

使用基本选择器是很容易获得元素, 但是在复杂的页面结构中, 基本选择器就不是那么方便了. '

例如下面的代码:

```html
<div>
    <input type="checkbox" /><br />
    <input type="checkbox" /><br />
    <input type="checkbox" /><br />
</div>
<input type="button" /><br />
```

想要获得 复选框, 我们很自然的想到, 需要获得 div 标签中的 input 标签. 所以我们需要层次选择器.

jQuery 中的各类选择器与 CSS 选择器的用法基本一致.



#### 1) 后代选择器

语法:

```javascript
'祖代选择器 后代选择器'
```

说明:

- 祖代选择器, 和后代选择器, 可以使用 ID, 类, 或标签选择器来描述.
  - 例如:
    - 可以选择 id 为 dv 下的所有 p 标签
    - 可以选择所有 div 标签下的 所有 span 标签
    - 可以选择含有 c 类样式的标签里的所有 i 标签
    - 等等
- 后代选择器所捕获的元素可以是子代, 也可以是子代的子代.
- 需要注意的是, 空格不能随意添加. 除非有其他选择器语法, 否则空格表示后代.



**演示案例:** 获得元素, 设置边框颜色

- 设置类样式 c 下所有的 div 的边框颜色
- 设置类样式 c0 下的使用 c1 类样式的所有 div
- 设置类样式 c 下的所有使用 c2 类样式的所有 div

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        div {
            padding: 20px;
            margin: 20px 0px;
            border: 1px dashed blue;
        }
    </style>
</head>
<body>
    <div class="c">
        <div class="c0">
            <div class="c1"></div>
            <div class="c2"></div>
        </div>
    </div>
    <div class="c">
        <div class="c0">
            <div class="c1"></div>
            <div class="c1"></div>
        </div>
    </div>
    <div class="c0">
        <div class="c1"></div>
        <div class="c2"></div>
    </div>
</body>
</html>
```





#### 2) 子代选择器

语法:

```javascript
'父代选择器 > 子代选择器'
```

说明:

- 子代选择器专门捕获某一个元素的子元素. 
  - 这里需要注意的是直接属于该元素的子元素. 
  - 不包含子元素的子元素.
- 其中父代选择器, 子代选择器可以使用 ID, 类, 或标签选择器来描述.
- 在大于符号两侧可以随意添加空格, 来是的代码方便阅读.



**演示案例:**

- 设置含有类样式 c 的元素的所有子代元素的边框颜色
- 设置含有 c1 类样式元素的子代元素中含有 c2 类样式的元素的边框色

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        div {
            padding: 20px;
            margin: 10px 0px;
            border: 1px dashed blue;
        }
    </style>
</head>
<body>
    <div class="c">
        <div class="c1">
            <div class="c1"></div>
            <div class="c2"></div>
            <div class="c3"></div>
        </div>
        <div class="c2"></div>
        <div class="c3"></div>
    </div>
</body>
</html>
```





#### 3) 紧邻选择器

语法:

```javascript
'前选择器 + 后选择器'
```

说明:

- 紧邻选择器类似于原生 DOM 中的 nextElementSibling 方法捕获的元素
  - 如果紧挨的后一个元素符合 "后选择器", 则会将其取出. 否则忽略.
- 其中前选择器, 后选择器可以使用 ID, 类, 或标签选择器来描述.
- 在加号两侧可以随意添加空格, 来是的代码方便阅读.



**演示案例:**

- 设置 p 标签紧挨的 span 标签的边框颜色
- 设置 p 标签紧挨的 i 标签的背景色

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        p, span, i, b {
            display: block;
            border: 1px solid blue;
            margin: 10px 0px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div>
        <p>p 标签</p>
        <span>span 标签</span>
        <p>p 标签</p>
        <i>i 标签</i>
        <p>p 标签</p>
        <b>b 标签</b>
        <p>p 标签</p>
        <span>span 标签</span>
    </div>
</body>
</html>
```









#### 4) 后续选择器

语法:

```javascript
'前选择器 ~ 后选择器'
```

说明:

- 紧邻选择器获得的元素是紧挨的后一个元素. 而后续选择器是获得当前元素后的所有元素.
- 其中前选择器, 后选择器可以使用 ID, 类, 或标签选择器来描述.
- 在弯弯符号两侧可以随意添加空格, 来是的代码方便阅读.





#### 5) 小结

jQuery 的选择器很多, 但是**不需要死记硬背**. 重点是使用, 可以经常查阅, 结合 CSS 选择器来使用.



| 选择器     | 案例        | 含义                                             |
| ---------- | ----------- | ------------------------------------------------ |
| 后代选择器 | `div span`  | 获得页面中所有 div 标签下的所有 span 标签        |
| 子代选择器 | `#dv > div` | 获得页面中 id 为 dv 的所有子元素中的 div 元素    |
| 紧邻选择器 | `ul a + ul` | 获得页面中 ul 标签里 前置元素为 a 元素的 ul 元素 |
| 后续选择器 | `#dv ~ div` | 获得 id 为 dv 的后续标签为 div 的所有兄弟元素    |



### 1.3 简单过滤器

所谓过滤, 就是筛选. 过滤器就是在已经找到的元素中进行过滤.

过滤器也是用于筛选捕获元素用的, 也是选择器.

#### 1) 基本语法说明

过滤器的语法:

```javascript
'选择器:过滤器'
// 或
'选择器:过滤器1:过滤器2'
```

说明:

- 过滤器一般使用冒号开头.
- 一般过滤器与选择器连用, 紧挨在一起. 
  - 表达的含义是: **在过滤器得到的元素基础上再进行一次筛选, 将符合过滤器的元素留下.**
- 过滤器与前置的选择器之间不允许有空格, 如果含有空格.
  - 例如: `#dv p :过滤器`. 注意 p 选择器与过滤器中间后一个空格.
  - 等价与: `#dv p *:过滤器`. 逻辑上相当于在 p 的所有后代元素中进行过滤.
  - 但是不加空格, 表示在 p 中进行过滤.
- 过滤器也可以连用, 逻辑上会从左往右依次进行过滤.
  - 前一个过滤器的结果接着被后一个过滤器进行过滤





#### 2) 基本过滤器简介

下面我们看看基本过滤器

| 过滤器           | 含义                            | 示例              | 描述                                 |
| ---------------- | ------------------------------- | ----------------- | ------------------------------------ |
| `:eq(index)`     | 在元素中取出第 index 个         | `$('li:eq(0)')`   | 取出第 0 个 li 标签                  |
| `:not(selector)` | 滤掉符合 selector 选择器的元素  | `$('li:not(.c)')` | 取出所有不含有 c 类样式的 li 元素    |
| `:first`         | 在元素中取出第 0 个             | `$('li:first')`   | 取出第 0 个 li 标签                  |
| `:last`          | 在元素中取出最后一个            | `$('li:last')`    | 取出最后一个 li 元素                 |
| `:even`          | 在元素中过滤出偶数项            | `$('tr:even')`    | 取出表格中的偶数行(0-base)           |
| `:odd`           | 在元素中过滤出奇数项            | `$('tr:odd')`     | 取出表格中的奇数行(0-base)           |
| `:gt(index)`     | 在元素中取出序号大于 index 的项 | `$('li:gt(3)')`   | 取出序号大于 3 的 li 标签            |
| `:lt(index)`     | 在元素中取出序号小于 index 的项 | `$('li:lt(3)')`   | 取出序号小于 3 的 li 标签            |
| `:header`        | 获得 h# 标签                    | `$(':header')`    | 获得页面中的所有 h 标签              |
| `:animated`      | 获得 正在播放 jQuery 动画的元素 | `$(':animated')`  | 获得页面上正在播放 jQuery 动画的元素 |

说明:

- :not 过滤器中可以使用其他任意的选择器
- :header 与 :animated 过滤器**一般**独立使用



#### 3) 案例

- tab 选项卡( 淘宝版 )
- 竖向选项卡
- 表格奇偶行变色





#### 4) 属性过滤器

有些时候需要利用属性来捕获元素的时候, 就需要使用属性过滤器了

常用属性过滤器

| 属性过滤器        | 含义                                                         |
| ----------------- | ------------------------------------------------------------ |
| `[属性名]`        | 在选择器获得的元素中检查是否含有该属性, 若有该属性则保留该元素 |
| `[属性名=属性值]` | 在选择器获得的元素中检查是否含有该属性, 并判断该属性的值.    |
| `[属性!=属性值]`  | 在选择器获得的元素中判断对应属性不为该值的元素               |

**演示案例**

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <input type="checkbox">测试项1 <br>
    <input type="checkbox">测试项2 <br>
    <input type="checkbox">测试项3 <br>
    <input type="checkbox">测试项4 <br>
    <input type="checkbox">测试项5 <br>
    <input type="button" value="全选" id="all">
    <input type="button" value="全不选" id="no">
    <input type="button" value="返选" id="des">

    <script src="../jquery/jquery-3.3.1.js"></script>
    <script>
        $( '#all' ).click( function () {
            $( '[type=checkbox]' ).prop( 'checked', true );
        } );

        $( '#no' ).click( function () {
            $( '[type=checkbox]' ).prop( 'checked', false );
        } );

        $( '#des' ).click( function () {
            $( '[type=checkbox]' ).each( function () {
                this.checked = !this.checked;
            } );
        } );

    </script>
</body>
</html>
```







### 1.4 小结

jQuery 的强大很大程度上是因为它拥有强大的选择器. 但是这些选择器不需要死记硬背. 关键是学一部分记一部分.

| 选择器       | 示例                                | 含义                                               |
| ------------ | ----------------------------------- | -------------------------------------------------- |
| `#id`        | `$('#dv')` 或 `jQuery( '#dv' )`     | id 选择器, 用于获得对应 id 的元素                  |
| `.className` | `$( '.btn' )` 或 `jQuery( '.btn' )` | 类选择器, 用于获得所有使用了该类样式的元素         |
| `div`        | `$( 'div' )` 或 `jQuery( 'div' )`   | 标签选择器, 直接使用标签名, 用于获得该标签元素     |
| `*`          | `$( '*' )` 或 `jQuery( '*' )`       | 通用选择器, 用于获得所有元素, **一般很少直接使用** |

| 选择器     | 案例        | 含义                                             |
| ---------- | ----------- | ------------------------------------------------ |
| 后代选择器 | `div span`  | 获得页面中所有 div 标签下的所有 span 标签        |
| 子代选择器 | `#dv div`   | 获得页面中 id 为 dv 的所有子元素中的 div 元素    |
| 紧邻选择器 | `ul a + ul` | 获得页面中 ul 标签里 前置元素为 a 元素的 ul 元素 |
| 后续选择器 | `#dv ~ div` | 获得 id 为 dv 的后续标签为 div 的所有兄弟元素    |

| 属性过滤器        | 含义                                                         |
| ----------------- | ------------------------------------------------------------ |
| `[属性名]`        | 在选择器获得的元素中检查是否含有该属性, 若有该属性则保留该元素 |
| `[属性名=属性值]` | 在选择器获得的元素中检查是否含有该属性, 并判断该属性的值.    |
| `[属性!=属性值]`  | 在选择器获得的元素中判断对应属性不为该值的元素               |









## 小结

1. 选择器( CSS )
2. 过滤器















## 2. 选择器对应的检索方法

检索元素的方式有两种

1. 亲属访问
2. 向上与向下查找

### 1) 亲属访问

DOM 构成一个树状结构, 所谓的亲属访问, 就是从当前元素开始, 访问其父元素, 兄弟元素以及子元素.

jQuery 提供了以下常用方法:

```javascript
jQuery 对象.parent();		// 访问其父元素
jQuery 对象.next();		// 访问其下一个兄弟元素
jQuery 对象.nextAll();	// 访问其后的所有兄弟元素
jQuery 对象.prev();		// 访问其上一个兄弟元素
jQuery 对象.prevAll();	// 访问其前面的所有兄弟元素
jQuery 对象.siblings();	// 访问除了自己以外的所有兄弟元素
```

说明:

- 这里列举的不是所有的方法与功能, 但是常用的就这些.
- 所有的方法都可以带有选择器作为参数, 逻辑上就是在对应的元素上进行筛选.



**案例举例:**

- 评分案例
- 高亮案例





### 2) 向上与向下查找

有时需要向父级以上的元素, 以及子元素或子级以下的元素进行查找. jQuery 也提供了相应的方法

```javascript
jQuery 对象.closest( '选择器' );	// 向父级以上进行查找最近的一个元素
jQuery 对象.children( '选择器' ); // 在子代元素中查找
jQuery 对象.find( '选择器' ); // 在后代元素中查找
```













## 3. 事件操作

### 3.1 基本事件方法

前面已经了解到常用事件的注册方式, 这里简单小结一下( 常用 )

| 方法名                    | 功能说明           |
| ------------------------- | ------------------ |
| `.click( callback )`      | 添加点击事件       |
| `.mouseover( callback )`  | 添加鼠标进入事件   |
| `.mouseout( callback )`   | 添加鼠标离开事件   |
| `.mousemove( callback )`  | 添加鼠标移动事件   |
| `.mouseenter( callback )` | 添加鼠标进入事件   |
| `.mouseleave( callback )` | 添加鼠标离开事件   |
| `.mousedown( callback )`  | 添加鼠标按下事件   |
| `.mouseup( callback )`    | 添加鼠标键抬起事件 |
| `.dblclick( callaback )`  | 添加双击事件       |
| `.keydown( callback )`    | 添加键盘按下事件   |
| `.keyup( callback )`      | 添加键盘抬起事件   |
| `.keypress( callback )`   | 添加键盘敲击事件   |
| `.blur( callback )`       | 添加失去焦点事件   |
| `.focus( callback )`      | 添加获得焦点事件   |

事件的案例多半与属性样式操作一起, 所以本节重点明确如何添加事件.





### 3.2 其他事件方法

#### 1) on 方法

语法:

```javascript
jQuery 对象.on( '事件名', 事件处理函数 );
```

说明:

- 该方法是标准方法. jQuery 中的很多方法都是由它来实现的. 
- 该方法的用法很多, 不比一一记住. 记住我们使用的即可. 详细的用法可以[参考文档](http://api.jquery.com/on/).
- 事件名是不带有 on 的. 这一点与 addEventListener 一样.
- 使用该方法可以添加任意的事件, 之前使用的实际上是快捷方法.
- 事件处理函数中的 this 为当前 DOM 对象.



**演示案例:** 点击按钮, 弹出一个对话框



**演示案例:** 列表鼠标悬浮高亮

1. 列表没有颜色, 鼠标悬浮后背景色为黄色
2. 列表本身奇偶行颜色不同( 奇数行为浅绿色, 偶数行为粉色 ), 鼠标悬浮为黄色





#### 2) hover 方法

鼠标进入与移出的事件使用得较为普遍. 但是每次都注册两个事件势必很麻烦. 

jQuery 提供的 hover 正好帮我们解决这个问题.

语法:

```javascript
jQuery 对象.hover( 函数1, 函数2 );
```

说明:

- 该方法是 mouseover 与 mouseout 的替代方案. 
  - 在鼠标进入的时候会调用 函数1
  - 在鼠标离开的时候会调用 函数2



**案例演示:** 鼠标进入矩形区域修改背景色, 离开后恢复







#### 3) toggle 方法

toggle 方法可以实现点击同一个按钮, 按照不同的点击次数依次执行不同的方法.

语法为:

```javascript
jQuery 对象.toggle( fn1, fn2, ..., fnN );
```

说明:

- toggle 的参数至少是两个函数.
- 在点击第 1 次的时候执行 fn1, 点击第 2 次的时候执行 fn2, 依次类推.
- 点击第 n 次的时候执行 fnN, 再点击第 n + 1 次的时候, 又回来执行 fn1, 然后循环.



**演示案例:** 开关灯案例







### 3.3 事件的触发

在 DOM 操作中, 我们可以调用某个元素的 click 方法来间接触发其点击事件.

在 jQuery 中也可以实现, 只需要使用语法

```javascript
jQuery 对象.trigger( '事件名' );
```

说明:

- 该方法可以在用户不进行默认操作的情况下触发事件.
- 该方法会执行绑定的事件处理函数, 同时执行默认的事件行为.



**演示案例:** 点击按钮, 触发另一个按钮注册的事件





### 3.4 事件对象

jQuery 中事件对象的使用也是非常的容易. 只需要在事件处理函数中提供参数即可.

语法参考:

```javascript
jQuery 对象.on( '事件名', function ( e ) {
    // 代码 ...
} );
// 或者
jQuery 对象.事件函数( function ( e ) {
    // 代码 ...
} );
```

说明:

- jQuery 事件对象的语法与 "标准事件对象" 的用法是一致的.
- 事件对象中提供了很多与输入信息有关的属性. 



#### 3.4.1 事件对象常用成员

##### 1) 常用事件成员

[事件对象的成员](http://api.jquery.com/category/events/event-object/)与标准对象的成员类似, 常用的成员如下:

| 属性              | 含义                                                     |
| ----------------- | -------------------------------------------------------- |
| `e.target`        | 获得事件源对象.                                          |
| `e.currentTarget` | 获得触发当前事件处理函数的 DOM 对象. 与 this 的含义一致. |
| `e.type`          | 获得事件类型.                                            |
| `e.which`         | 获得鼠标按下时的按键信息.                                |
| `e.keyCode`       | 获得键盘按下的键位码.                                    |



##### 2) 阻止事件冒泡与事件的默认行为

jQuery 中阻止事件冒泡与取消事件的默认行为也是标准语法.

```javascript
// 取消事件冒泡
事件对象.stopPropagation();
// 阻止事件的默认行为
事件对象.preventDefault();
```

说明:

- 取消事件冒泡, 在 IE 低版本浏览器中使用事件对象的 cancelBubble 属性.
- 取消事件默认行为和在事件处理函数中返回 false 逻辑相同.





##### 3) 事件代理

由于存在事件冒泡, 因此我们可以利用给父元素注册事件, 然后由子元素触发, 来实现事件操作.

这样的处理方式我们称为 **事件代理**.

早期原生 JavaScript 来实现事件代理是很繁琐的. jQuery 提供了一个非常便利的办法. 语法如下:

```javascript
jQuery 对象.on( '事件名', '被代理元素的选择器', 事件处理函数 );
```

说明:

- 该方法现在可能使用较少, 后期学习了模板引擎后会经常使用该方法. 所以先记住其用法与特点.
- 调用 on 方法的 jQuery 对象存储的是父元素.
- 事件处理函数与事件绑定时的事件处理函数一样.
- 事件处理函数中的 this 是当前元素( 被代理元素 ).



**案例演示:** 表格高亮案例























































